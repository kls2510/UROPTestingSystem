<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/core-collapse/core-collapse.html">
<link rel="import" href="../../bower_components/core-ajax/core-ajax.html">
<link rel="import" href="../../bower_components/paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">

<polymer-element name="static-test-card">
    <template>
        <style>
            .checkboxContainer {
                padding: 20px 20px 20px 0;
                margin: 0;
            }
            h4 {
                padding: 0;
                margin-bottom: -10px;
            }
            #mainContainer {
                margin-top: 0;
                padding: 0 20px;
            }
            paper-checkbox::shadow #ink {
                top: -16px;
                left: -16px;
                width: 50px;
                height: 50px;
            }
            paper-checkbox {
                /* Firefox/IE compatibility */
                width: 15px;
                height: 15px;
            }
            paper-button {
                margin: 20px;

                width: 10em;
                height: 35px; /* Firefox/IE compatibility */
            }
            paper-button.colored {
                background: #009933;
                color: #fff;
            }
            paper-toggle-button {
                margin-top: 23px;
                margin-left: 8px;
            }
            #day, #month {
                width: 50px;
            }
            #year {
                width: 100px;
            }
        </style>

        <div id="mainContainer">
            <h4>CODE TEMPLATE (optional)</h4>
            <br>
            <span layout horizontal>
                <paper-input id="inputTemplateRepo" flex label="Repository Address" floatinglabel></paper-input>
            </span>

            <div layout horizontal>
                <h4>DEADLINE</h4>
                <paper-toggle-button id="deadlineSwitch" on-up="{{toggleDeadline}}"></paper-toggle-button>
            </div>
            <core-collapse id="collapseDeadline">
                <br>
                <span layout horizontal>
                    <paper-input id="day" label="DD" floatinglabel="true"></paper-input>
                    <paper-input id="month" label="MM" floatinglabel="true"></paper-input>
                    <paper-input id="year" label="YYYY" floatinglabel="true"></paper-input>
                </span>
            </core-collapse>
            <br>

            <h4>CORRECTNESS CHECKS</h4>
            <br>
            <span layout horizontal>
                <paper-input id="inputCorrectnessRepo" flex label="Repository Address" floatinglabel></paper-input>
            </span>

            <h4>STYLISTIC CHECKS</h4>
            <div class="checkboxContainer" layout horizontal>
                <paper-checkbox checked="{{useDefaults}}" on-tap="{{toggleStylistic}}"></paper-checkbox>
                <span flex style="padding-left: 15px; margin: 0;">Use Defaults</span>
            </div>
            <core-collapse id="collapseStylistic">
                <static-list-labels></static-list-labels>
                <static-list id="staticList"></static-list>
            </core-collapse>

            <!-- SAVE button -->
            <span layout horizontal>
                <span flex></span>
                <paper-button raisedButton class="colored" label="SAVE" on-tap="{{saveTick}}"></paper-button>
                <span flex></span>
            </span>
        </div>
    </template>
    <script>
        Polymer('static-test-card', {
            ready: function() {
                this.useDefaults = true;
            },
            toggleStylistic: function() {
                this.$.collapseStylistic.toggle();
            },
            toggleDeadline: function() {
                //work around for slider bug
                var that = this.$;
                setTimeout(function(){that.collapseDeadline.opened = that.deadlineSwitch.checked;}, 100);
            },
            saveTick: function () {
                //TODO: actually save the tick. For now, print all required data to console
                console.log();
                console.log("Code template repo: " + this.$.inputTemplateRepo.inputValue);

                console.log("Deadline? " + this.$.deadlineSwitch.checked);
                if (this.$.deadlineSwitch.checked) {
                    var year = this.$.year.inputValue;
                    var month = this.$.month.inputValue;
                    var day = this.$.day.inputValue;
                    var date = new Date(year, month - 1, day);
                    console.log(date.toISOString());
                    console.log(date.toDateString());
                }

                console.log("Correctness tests repo: " + this.$.inputCorrectnessRepo.inputValue);

                console.log("Use defaults? " + this.useDefaults);
                if (!this.useDefaults) {
                    var saveOptions = [];
                    for (var i = 0; i < this.$.staticList.staticOptions.length; i++) {
                        if (!(this.$.staticList.staticOptions.closed)) {
                            saveOptions[saveOptions.length] = {text: this.$.staticList.staticOptions[i].text,
                                checkedIndex: this.$.staticList.staticOptions[i].checkedIndex};
                        }
                    }

                    for (var i = 0; i < saveOptions.length; i++) {
                        console.log(saveOptions[i]);
                    }
                }
            }
        });
    </script>
</polymer-element>